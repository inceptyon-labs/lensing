---
# lensing-1zar
title: Add REST endpoints for marketplace browse/search
status: completed
type: task
priority: high
created_at: 2026-02-28T15:46:39Z
updated_at: 2026-02-28T18:03:54Z
parent: lensing-7nct
---

REST API endpoints that expose marketplace data to the admin UI.

## Acceptance Criteria

- [x] GET /marketplace — list all plugins (supports ?category, ?search, ?page query params)
- [x] GET /marketplace/:id — single plugin detail
- [x] GET /marketplace/categories — list available categories with counts
- [x] Search filters by name, description, tags (case-insensitive substring)
- [x] Response includes "installed" and "update_available" flags per plugin
- [x] Returns offline banner flag when serving from cache

---

**Size:** M
**Area:** backend

## Completed

**Files changed:**
- packages/types/src/index.ts (added MarketplacePlugin, MarketplaceCategory, MarketplaceListResponse types)
- packages/core/src/rest-server.ts (added handler interfaces + 3 route handlers)
- packages/core/src/__tests__/rest-server-marketplace.test.ts (new, 12 tests)

**Key decisions:**
- Used addRoute() for /marketplace and /marketplace/categories (exact matches via route table)
- Used regex matching for /marketplace/:id (parameterized), with decoded path check for reserved 'categories' path
- Query params parsed via URL.searchParams and forwarded as Record<string, string> to handler
- All handler calls wrapped in try-catch with specific error messages (per Codex review)
- Invalid URI encoding returns 400 (not 500), per Codex review finding

**Notes for next task:**
- Handler interfaces are optional (getMarketplacePlugins?, getMarketplacePlugin?, getMarketplaceCategories?)
- Handlers must be wired up by the host service or marketplace client to actually serve data
- The filtering/search logic is delegated to the handler implementation, not done in the REST layer
- Use MarketplaceListResponse type for paginated list responses

---
*Auto-generated by PASIV*
